--Creer par Thibaut Branlant L3 Informatique ULCO Calais
DROP TABLE HYPERMARCHE CASCADE CONSTRAINTS;
DROP TABLE RAYON CASCADE CONSTRAINTS;
DROP TABLE PRODUITS CASCADE CONSTRAINTS;
DROP TABLE EMPLOYE CASCADE CONSTRAINTS;

CREATE TABLE EMPLOYE (
    NUMERO VARCHAR(60) NOT NULL,
    NOM VARCHAR(60) NOT NULL,
    PRENOM VARCHAR(60) NOT NULL,
    ADRESSE VARCHAR(60),
    
    CONSTRAINT PK_EMPLOYE PRIMARY KEY (NUMERO)
);

CREATE TABLE HYPERMARCHE (
    NUMERO VARCHAR(60) NOT NULL,
    NOM VARCHAR(60) NOT NULL,
    ADRESSE VARCHAR(50) NOT NULL,
    VILLE VARCHAR(60) NOT NULL,
    CODEPOSTAL INT NOT NULL,
    NUMERODIRECTEUR VARCHAR(60) NOT NULL,
    
    CONSTRAINT fk_numerodirecteur
        FOREIGN KEY (NUMERODIRECTEUR)
        REFERENCES EMPLOYE(NUMERO),
        
    CONSTRAINT PK_HYPERMARCHE PRIMARY KEY (NUMERO)
);

CREATE TABLE RAYON (
    NUMERO VARCHAR(60) NOT NULL,
    NOM VARCHAR(60) NOT NULL,
    DESCRIPTIF VARCHAR(150) NOT NULL,
    CHIFFREAFFAIRE INT NOT NULL,
    NUMEROHYPER VARCHAR(60) NOT NULL,
    NUMERORESPONSABLE VARCHAR(60) NOT NULL,
    
    CONSTRAINT fk_numeroresponsable
        FOREIGN KEY (NUMERORESPONSABLE)
        REFERENCES EMPLOYE(NUMERO),
        
    CONSTRAINT fk_numerohyper
        FOREIGN KEY (NUMEROHYPER)
        REFERENCES HYPERMARCHE(NUMERO),
    
    CONSTRAINT PK_RAYON PRIMARY KEY (NUMERO)
);

CREATE TABLE PRODUITS (
    NUMERO VARCHAR(60) NOT NULL,
    LIBELLE VARCHAR(60) NOT NULL,
    NUMERORAYON VARCHAR(60) NOT NULL,
    PRIXUNITAIRE FLOAT NOT NULL,
    UNITE VARCHAR(60) NOT NULL,
    QUANTITESTOCKHYPER INT NOT NULL,
    
    CONSTRAINT fk_numerorayon
        FOREIGN KEY (NUMERORAYON)
        REFERENCES RAYON(NUMERO),
    
    CONSTRAINT PK_PRODUIT PRIMARY KEY (NUMERO)
);

INSERT INTO EMPLOYE VALUES ('EMP1090','DUPONT','Jean','332, rue jean-dupont, Calais');
INSERT INTO EMPLOYE VALUES ('EMP1301','DUVIVIER','Renaud','345, rue renaud-duviver, Paris');
INSERT INTO EMPLOYE VALUES ('EMP1208','GODART','Claude','674, rue claude-godart, Ardre');
INSERT INTO EMPLOYE VALUES ('EMP2025','FONTAINE','Fabien','456, rue jean-louis, Calais');
INSERT INTO EMPLOYE VALUES ('EMP1505','VASSEUR','Jacques','778, rue vasseur, Saint-Omer');
INSERT INTO EMPLOYE VALUES ('EMP7645','BERNARD','Martin','876, rue martin, Sangatte');
INSERT INTO EMPLOYE VALUES ('EMP2341','RICHARD','Philipe','955, rue bernard, Coudekerque ');
INSERT INTO EMPLOYE VALUES ('EMP8765','Hugo','Victor','432,rue victor-hugo, Frethun');
INSERT INTO EMPLOYE VALUES ('EMP4328','Stevenson','Max','874, rue max-stevenson, Cologne');
INSERT INTO EMPLOYE VALUES ('EMP7862','DURAND','Christophe','543, rue durand, Calais');


INSERT INTO HYPERMARCHE VALUES ('HYP12','Marrefour Coquelles', '12 Bd du Kent', 'Coquelles','62231','EMP1090');
INSERT INTO HYPERMARCHE VALUES ('HYP56','DO-SPORT','45 AVBlue','Calais','62100','EMP1208');
INSERT INTO HYPERMARCHE VALUES ('HYP76','Marrefour Market','68 AV Bleriot','Lille','59160','EMP1301');
INSERT INTO HYPERMARCHE VALUES ('HYP43','Dealer Price','52, Bd Hugo','Calais','62100','EMP8765');

INSERT INTO RAYON VALUES ('RAY34','Boucherie','vente de viandes volailles etc.',1000000,'HYP12','EMP7862');
INSERT INTO RAYON VALUES ('RAY45','Textile','Vetements',50000000,'HYP56','EMP1505');
INSERT INTO RAYON VALUES ('RAY67','Chaussure','Des chaussures de cuir des chaussures de marche',800000,'HYP56','EMP7645');
INSERT INTO RAYON VALUES ('RAY86','Poissonnerie','Poissonerie traiteur,plateau defruits de mer.',950000,'HYP12','EMP2341');
INSERT INTO RAYON VALUES ('RAY19','Légumes','Fruits et Légumes',450000,'HYP43','EMP4328');
INSERT INTO RAYON VALUES ('RAY98','Boucherie','vente de viandes volailles etc.',500000,'HYP43','EMP2025');


INSERT INTO PRODUITS VALUES ('PR1234', 'Côtes de bœuf', 'RAY34', 12.5, 'kg', 345);
INSERT INTO PRODUITS VALUES ('PR5783','Chaussure Mike','RAY67',109.99,'unité',56660);
INSERT INTO PRODUITS VALUES ('PR6765','SWEAT CORERUNNER','RAY45',59.00,'unité',87778);

delete from hypermarche where nom like 'Marrefour Market';
UPDATE rayon SET numeroresponsable = (SELECT NUMERO FROM employe where nom like 'VASSEUR' and prenom like 'Jacques') 
where numeroresponsable = (SELECT NUMERO FROM employe where nom like 'RICHARD' and prenom like 'Philipe');



